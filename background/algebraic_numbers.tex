%BEGIN SODA

\subsection{Algebraic Numbers}

The purpose of this section is threefold: to introduce the main concepts in Algebraic Number Theory, necessary to understanding the hypothesis for the $S$-units theorem, stated below; to justify the application of the aforementioned result in lower-bounding the dominant terms of linear recurrence sequences; to explain how one can effectively manipulate algebraic numbers.

\subsection{Preliminaries}

A complex number $\alpha$ is said to be \textbf{algebraic} if it is the root of some polynomial with integer coefficients. Among those polynomials, there exists a unique one of minimal degree whose coefficients have no common factor, and it is said to be the \textbf{defining polynomial} of $\alpha$, denoted by $p_\alpha$, and it is always an irreducible polynomial. Moreover, if $p_\alpha$ is monic, $\alpha$ is said to be an \textbf{algebraic integer}. The degree of an algebraic number is defined as the degree of $p_\alpha$, and its height as the maximum absolute value of the coefficients of $p_\alpha$ (also said to be the height of that polynomial). The roots of $p_\alpha$ are said to be the \textbf{Galois conjugates} of $\alpha$. We denote the set of algebraic numbers by $\mathbb{A}$, and the set of algebraic integers by $\mathcal{O}_\mathbb{A}$. For all $\alpha\in\mathbb{A}$, there exists some $n\in\mathbb{N}$ such that $n\alpha\in\mathcal{O}_\mathbb{A}$. It is well known that $\mathbb{A}$ is a field and that $\mathcal{O}_\mathbb{A}$ is a ring.

A \textbf{number field} of dimension $d$ is a field extension $K$ of $\mathbb{Q}$ whose degree as a vector-space over $\mathbb{Q}$ is $d$. In particular, $K\subseteq\mathbb{A}$ must hold. Recall that, in that case, there are exactly $d$ monomorphisms $\sigma_i:K\rightarrow\mathbb{C}$ whose restriction over $\mathbb{Q}$ is the identity (and therefore these must map elements of $K$ to their Galois conjugates). The \textbf{ring of integers} $\mathcal{O}$ of a number field $K$ is the set of elements of $K$ that are algebraic integers, that is, $\mathcal{O}=K\cap\mathcal{O}_\mathbb{A}$. An ideal of $\mathcal{O}$ is an additive subgroup of $\mathcal{O}$ that is closed under multiplication by any element of $\mathcal{O}$. An ideal $\mathfrak{P}$ is said to be prime if $ab\in \mathfrak{P}$ implies $a\in\mathfrak{P}$ or $b\in\mathfrak{P}$. The following theorem is central in Algebraic Number Theory \cite{SnT}:

\begin{theorem}
In any ring of integers, ideals can be uniquely factored as products of prime ideals up to permutation.
\end{theorem}

\subsection{Lower-bounding simple linear recurrence sequences}

We are interested in lower-bounding expressions of the form
\begin{equation}
\label{eq:sum}
u_n=\sum\limits_{j=1}^s\alpha_j\lambda_j^n
\end{equation}
where the $\alpha_j$ are algebraic-integer constants and $\lambda_1,\ldots,\lambda_s$ have the same absolute value $\rho$. Any such sequence must in fact be a simple linear recurrence sequence with algebraic coefficients and characteristic roots $\lambda_1,\ldots,\lambda_s$, as explained in Section 1.1.6 of \cite{BOOK}.

The next theorem, by Evertse, van der Poorten, and Schlickewei, was established in \cite{Evertse84,PS82} to
analyse the growth of linear recurrence sequences. It gives us a very strong lower bound on the magnitude of sums of $S$-units, as defined below. Its key ingredient is Schlickewei's $p$-adic generalisation \cite{Sch77} of Schmidt's
Subspace theorem.

Let $S$ be a finite set of prime ideals of the ring of integers
$\mathcal{O}$ of a number field $K$. We say that
$\alpha\in\mathcal{O}$ is an \textbf{$S$-unit} if all the ideals
appearing in the prime factorisation of $(\alpha)$, that is, the ideal
generated by $\alpha$, are in $S$.

\begin{theorem}[$S$-units]
\label{thm:s-units}
Let $K$ be a number field, $s$ be a positive integer, and $S$ be a
finite set of prime ideals of $\mathcal{O}$. Then for every
$\varepsilon>0$ there exists a constant $C$, depending only on $s$,
$K$, $S$, and $\varepsilon$, with the following property. For every
set of $S$-units $x_1,\ldots,x_s\in\mathcal{O}$ such that
$\sum\limits_{i\in I} x_i\neq 0$ for all non-empty $I\subseteq\lbrace
1,\ldots,s\rbrace$, it holds that
\[ \lvert x_1+\cdots+x_s \rvert\geq CYZ^{-\varepsilon} \]
where $Y=\max\lbrace \lvert x_j\rvert : 1\leq j\leq s \rbrace$ and $Z=\max\lbrace \sigma_i(x_j): 1\leq j\leq s,1\leq i\leq d \rbrace$ and $\sigma_i$ represent the different monomorphisms from $K$ to $\mathbb{C}$.
\end{theorem}

In order to make use of this result, it is important to understand the set
\begin{equation}
\lbrace n\in\mathbb{N}: \exists I\subseteq \lbrace 1,\ldots,s\rbrace, \sum\limits_{j\in I}\alpha_j\lambda_j^n=0\rbrace
\label{eq:genzeros}
\end{equation}

The following well-known theorem characterises the set of zeros of
linear recurrence sequences. In particular, it gives us a sufficient
condition for guaranteeing that the set of zeros of a non-identically
zero linear recurrence sequence is finite. Namely, it suffices that the sequence is non-degenerate, that is, that no ratio of two of its characteristic roots is a root of unit.

\begin{theorem}[Skolem-Mahler-Lech]
Let $u_n=\sum\limits_{j=1}^l \alpha_j\lambda_j^n$ be a linear recurrence sequence. The set $\lbrace n\in\mathbb{N}: u_n=0\rbrace$ is always a union of a finite set and finitely many arithmetic progressions. Moreover, if $u_n$ is non-degenerate, this set is actually finite.
\end{theorem}

Therefore, it follows from the Skolem-Mahler-Lech theorem that if $u_n$ is non-degenerate  then (\ref{eq:genzeros}) must be finite, assuming without loss of generality that $\sum\limits_{j\in I}\alpha_j\lambda_j^n$ is never eventually zero.

We can now apply the $S$-units theorem in order to get a lower bound on (\ref{eq:sum}) that holds for all but finitely many $n$, by letting $K$ be the splitting field of the characteristic polynomial of $u_n$, $S$ be the set of prime ideals of the ring of integers of $K$ that appear in the factorisation of each of the algebraic integers $\alpha_j$ and $\lambda_j$, and $x_j=\alpha_j\lambda_j^n$ for each $j$, making (\ref{eq:sum}) a sum of $S$-units.

In the notation of the theorem, we have $Y=\Omega(\rho^n)$. If $\Lambda$ is an upper bound on the absolute value of the Galois conjugates of each $\lambda_j$ (that is, each $\sigma_i(\lambda_j)$), then $Z=O(\Lambda^n)$. Thus, for any $\varepsilon>0$, we know that
\begin{align*}
\sum\limits_{j=1}^s\alpha_j\lambda_j^n &=\Omega(YZ^{-\varepsilon})=
\Omega\left(\rho^n\Lambda^{-n\varepsilon}\right)
\end{align*}
Finally, we note that by picking $\varepsilon$ to be sufficiently small we can get $\rho\Lambda^{-\varepsilon}$ arbitrarily close to $\rho$.

\subsection{Manipulating algebraic numbers}

The following separation bound allows us to effectively represent an arbitrary algebraic number by keeping its defining polynomial, a sufficiently accurate estimate for the root we want to store, and an upper bound on the error. We call this its \textbf{standard/canonical representation}.

\begin{lemma}[Mignotte]
Let $f\in\mathbb{Z}[x]$. Then
\begin{equation}
f(\alpha_1)=0=f(\alpha_2)\Rightarrow \lvert \alpha_1-\alpha_2\rvert>\frac{\sqrt{6}}{d^{(d+1)/2}H^{d-1}}
\end{equation}
where $d$ and $H$ are respectively the degree and height of $f$.
\end{lemma}

It is well known that arithmetic operations and equality testing on these numbers can be done in polynomial time on the size of the canonical representations of the relevant numbers, since one can:
\begin{itemize}
\item compute polynomially many bits of the roots of any polynomial $p\in\mathbb{Q}[x]$ in polynomial time, due to the work of Pan in \cite{Pan97}
\item find the minimal polynomial of an algebraic number by factoring the polynomial in its description in polynomial time using the LLL algorithm \cite{LenstraLenstraLovasz1982}
\item use the sub-resultant algorithm (see Algorithm 3.3.7 in \cite{Coh93}) and the two aforementioned procedures to compute canonical representations of sums, differences, multiplications, and divisions of canonically represented algebraic numbers
\end{itemize}

Moreover, we need to know how to decide whether a given canonically represented algebraic number $\alpha$ is a root of unity, that is, whether $\alpha^r=1$ for some $r$. If that is the case, then its defining polynomial will be the $r$-th cyclotomic polynomial, which has degree $\phi(r)$, if $r$ is taken to be minimal, that is, if $\alpha$ is a primitive $r$-th root of unity. The following (crude) lower bound on $\phi(r)$ allows us to decide this in polynomial time, assuming that the degree of $\alpha$ is given in unary.

\begin{lemma}
Let $\phi$ be Euler's totient function. Then $\phi(r)\geq\sqrt(r/2)$. Therefore, if $\alpha$ has degree $n$ and is a $r$-th root of unity, then $r\leq 2n^2$.
\end{lemma}

Therefore, in order to decide whether an algebraic number $\alpha$ of degree $n$ is a root of unity, we check whether it is a $r$-th root of unity, for each $r\leq 2n^2$. In order to test whether $\alpha$ is a $r$-th root of unity, it suffices to see whether $\mathit{gcd}(p_\alpha,x^r-1)=p_\alpha$, since we know that $x^r-1$ is the product of each $d$-th cyclotomic polynomial, with $d$ ranging over the divisors of $n$.

%END SODA
